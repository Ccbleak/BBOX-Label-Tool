标注工具源码及部分解析

　　该工具由Python语言编写（Python3），主要使用了tkinter库来进行GUI界面设计。　

　　由于某些图片分辨率过高，载入后会使得GUI界面显示不完全，故代码第23行设置了缩放后图片的大小，这里的分辨率需要按照个人显示屏的大小进行调整，例如24英寸左右的屏幕设置为1200, 900，而13英寸的屏幕则设置为720, 540较为适宜，这里的比例4:3是根据笔者数据集的原图1600:1200的分辨率来设置的。此处参考了Qiushi的想法。

　　而要进行行人重识别工作，就要将行人区分开来，所以代码第91行至第106行设置了行人的ID编号，考虑到笔者的数据集中，同一张图像里出现的行人数大多在8个以内，故将ID设置为从1到8。可以用鼠标在GUI界面进行点击选择，也可以使用键盘数字1~8来进行选择。此处参考了达文喜的想法。

　　同时，因为存在遮挡、背光、行人像素过少等原因，行人的识别难度也有区别，我们在进行实验的时候必须要考虑到这些因素，因此代码第108行至第123行设置了bounding box里行人识别的难易程度，分为easy、hard和very，分别表示容易识别、难以识别和极难识别。可以用鼠标在GUI界面进行选择，也可以使用键盘E、H或V来进行选择。

　　考虑到一张图像中某个行人不可能出现多次，所以代码第353行至第360行进行了设置。每当我们框出一个person，ID就会自动加一；如果前一个框的ID是8，则当前框的ID为1。

---

使用方法

1. 修改源代码第23行，改为适合自己屏幕大小的分辨率
2. 代码第183行设置了目标图像格式为jpg，如需标注png图片可自行更改
3. 将该源码保存为py文件，比如labelbbox.py，保存到工程目录下（其实任意位置都可以）
4. 在终端中cd到该py文件的目录下，然后运行该脚本
       cd XXX # 你存放的目录
       python labelbbox.py
   弹出的界面如下所示
   
5. 点击右上角的Load按钮载入需要标注的图片的文件夹，然后所有该文件夹下的图片都会被载入
   
6. 载入后GUI界面上会自动显示目标行人的example和第一张图片，我们即可开始使用鼠标画框
   - 画框时默认第一个框的ID为1，难易程度为easy，如需更改务必在画框前进行更改
   - 画第二个框及后续框的时候，每画一个，ID会自动加一，但难易程度保持不变；亦即上一个框选择了hard，那么当前框的难易程度也默认为hard，如需更改务必在画框前进行更改
7. GUI界面的右侧有一个显示标注结果的list，每当框出一个人，就会显示该person的ID以及识别的难易程度，如下图所示
   
8. 若标记起始点选择错误，可使用Esc键取消；若画成的框有问题，可以在右侧的list中点击有问题的框，按下面的Delete按钮删除，或按Clear All按钮清空所有的框
9. 标注完该文件夹的一张图片后，可使用左下角的Next >>按钮或键盘上的D键载入下一张图片开始标注；同理可使用左下角的<< Prev按钮或键盘上的A键重新载入之前标记过的图片进行更改。注意每次新载入一张图片时，ID会自动变为1，难易程度会自动变为easy
10. 每当新载入图片（上一张或下一张）时，当前标注的结果都会在该图片所属的文件夹下被保存为一个txt文件
    
    文件名是由所标注的图片1.jpg得到，第一行的7表示一共有7个框，下面的7行是详细情况，各列分别表示的是(ID, difficulty, xmin, ymin, xmax, ymax)
11. 处理完该文件夹下所有的图片后可以按GUI界面右上角的Load重新载入另一个文件夹
